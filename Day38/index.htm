<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="assets/WebMÂ®Â®Â®.svg">
<title>Todo</title>

<style>
:root {
  --bg: #0a192f;
  --card: #112240;
  --accent: #64ffda;
  --danger: #ff4d6d;
  --text: #e6f1ff;
  --muted: #8892b0;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
}

.app {
  max-width: 900px;
  margin: auto;
  padding: 24px;
}

h1 {
  text-align: center;
  color: var(--accent);
  margin-bottom: 20px;
}

form {
  display: flex;
  gap: 12px;
  margin-bottom: 16px;
}

input {
  flex: 1;
  padding: 14px;
  border-radius: 10px;
  border: 1px solid var(--accent);
  background: var(--card);
  color: var(--text);
  font-size: 16px;
}

button {
  padding: 14px 18px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  font-size: 16px;
  background: var(--accent);
  color: #000;
}

.filters {
  display: flex;
  gap: 10px;
  margin-bottom: 16px;
}

.filters button {
  background: transparent;
  color: var(--accent);
  border: 1px solid var(--accent);
}

.todo-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
  max-height: 65vh;
  overflow-y: auto;
}

.todo {
  background: var(--card);
  border-radius: 12px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.todo-header {
  display: flex;
  align-items: center;
  gap: 12px;
}

.todo-header span {
  flex: 1;
}

.todo.completed span {
  text-decoration: line-through;
  color: var(--muted);
}

.actions {
  display: flex;
  gap: 8px;
}

.actions button {
  background: transparent;
  border: 1px solid var(--accent);
  color: var(--accent);
  min-width: 42px;
  min-height: 42px;
}

.actions .delete {
  border-color: var(--danger);
  color: var(--danger);
}

.subtasks {
  margin-left: 24px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

</style>
</head>

<body>
<div class="app">
  <h1>Todo</h1>

  <form id="form">
    <input id="input" placeholder="Neue Aufgabe..." />
    <button type="submit">+</button>
  </form>

  <div class="filters">
    <button onclick="setFilter('all')">Alle</button>
    <button onclick="setFilter('open')">Offen</button>
    <button onclick="setFilter('done')">Erledigt</button>
  </div>

  <div class="todo-list" id="list"></div>
</div>

<script>
let todos = [];

try {
  todos = JSON.parse(localStorage.getItem('todos')) || [];
} catch {
  localStorage.removeItem('todos');
  todos = [];
}

todos = todos.map(t => ({
  text: t.text ?? '',
  done: Boolean(t.done),
  subs: Array.isArray(t.subs) ? t.subs : []
}));


let filter = 'all';

const list = document.getElementById('list');
const input = document.getElementById('input');
const form = document.getElementById('form');

form.onsubmit = e => {
  e.preventDefault();
  if (!input.value.trim()) return;
  todos.push({ text: input.value, done: false, subs: [] });
  input.value = '';
  save();
};

function save() {
  localStorage.setItem('todos', JSON.stringify(todos));
  render();
}

function setFilter(f) {
  filter = f;
  render();
}

function render() {
  list.innerHTML = '';
  todos
    .filter(t => filter === 'all' || (filter === 'done' && t.done) || (filter === 'open' && !t.done))
    .forEach((t, i) => {
      const el = document.createElement('div');
      el.className = `todo ${t.done ? 'completed' : ''}`;
      el.innerHTML = `
        <div class="todo-header">
          <span contenteditable="true" onblur="edit(${i}, this.innerText)">${t.text}</span>
          <div class="actions">
            <button onclick="toggle(${i})">âœ“</button>
            <button onclick="addSub(${i})">ï¼‹</button>
            <button class="delete" onclick="del(${i})">ðŸ—‘</button>
          </div>
        </div>
        <div class="subtasks">
          ${t.subs.map((s, si) => `
            <div class="todo ${s.done ? 'completed' : ''}">
              <div class="todo-header">
                <span contenteditable="true" onblur="editSub(${i},${si},this.innerText)">${s.text}</span>
                <div class="actions">
                  <button onclick="toggleSub(${i},${si})">âœ“</button>
                  <button class="delete" onclick="delSub(${i},${si})">ðŸ—‘</button>
                </div>
              </div>
            </div>
          `).join('')}
        </div>
      `;
      list.appendChild(el);
    });
}

function toggle(i){ todos[i].done=!todos[i].done; save(); }
function del(i){ todos.splice(i,1); save(); }
function edit(i,t){ todos[i].text=t.trim(); save(); }

function addSub(i){
  const text = prompt('Unteraufgabe:');
  if(text) { todos[i].subs.push({text,done:false}); save(); }
}

function toggleSub(i,si){ todos[i].subs[si].done=!todos[i].subs[si].done; save(); }
function delSub(i,si){ todos[i].subs.splice(si,1); save(); }
function editSub(i,si,t){ todos[i].subs[si].text=t.trim(); save(); }

render();
</script>
</body>
</html>
